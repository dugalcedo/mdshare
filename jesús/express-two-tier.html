<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Express + React Deployment Explained</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .lang-toggle {
            margin-top: 15px;
        }

        .lang-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid white;
            padding: 8px 20px;
            margin: 0 5px;
            cursor: pointer;
            border-radius: 20px;
            font-size: 14px;
            transition: all 0.3s;
        }

        .lang-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        .lang-btn.active {
            background: white;
            color: #2c3e50;
        }

        .content {
            padding: 40px;
        }

        section {
            margin-bottom: 40px;
        }

        h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.5em;
            border-left: 4px solid #667eea;
            padding-left: 15px;
        }

        h3 {
            color: #764ba2;
            margin: 20px 0 10px 0;
            font-size: 1.2em;
        }

        p {
            margin-bottom: 15px;
            color: #333;
        }

        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
        }

        .highlight {
            background: rgba(102, 126, 234, 0.1);
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        .step-number {
            display: inline-block;
            background: #667eea;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            font-weight: bold;
            margin-right: 10px;
        }

        .diagram {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }

        .box {
            display: inline-block;
            padding: 15px 25px;
            margin: 10px;
            border-radius: 8px;
            font-weight: bold;
        }

        .box.backend {
            background: #3498db;
            color: white;
        }

        .box.frontend {
            background: #e74c3c;
            color: white;
        }

        .box.combined {
            background: #2ecc71;
            color: white;
        }

        .arrow {
            font-size: 24px;
            color: #95a5a6;
            margin: 0 10px;
        }

        .important {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }

        .lang-content {
            display: none;
        }

        .lang-content.active {
            display: block;
        }

        ul {
            margin-left: 30px;
            margin-bottom: 15px;
        }

        li {
            margin-bottom: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1 class="lang-content active" data-lang="en">Understanding Express + React Deployment</h1>
            <h1 class="lang-content" data-lang="es">Entendiendo el Despliegue de Express + React</h1>
            <p class="lang-content active" data-lang="en">How to serve a React frontend from an Express backend</p>
            <p class="lang-content" data-lang="es">CÃ³mo servir un frontend de React desde un backend de Express</p>
            <div class="lang-toggle">
                <button class="lang-btn active" onclick="setLanguage('en')">English</button>
                <button class="lang-btn" onclick="setLanguage('es')">EspaÃ±ol</button>
            </div>
        </header>

        <div class="content">
            <!-- ENGLISH CONTENT -->
            <div class="lang-content active" data-lang="en">
                <section>
                    <h2>The Big Picture</h2>
                    <p>You have two separate applications that need to work together as one:</p>
                    <div class="diagram">
                        <div class="box backend">Backend (Express)</div>
                        <span class="arrow">+</span>
                        <div class="box frontend">Frontend (React)</div>
                        <span class="arrow">â†’</span>
                        <div class="box combined">Single Deployment</div>
                    </div>
                    <p>The goal is to make Express serve both the API endpoints AND the React application from the same URL.</p>
                </section>

                <section>
                    <h2>Step-by-Step Explanation</h2>

                    <h3><span class="step-number">1</span>Build Scripts Setup</h3>
                    <div class="code-block">"scripts": {
  "install-backend": "cd backend && npm install && cd ..",
  "install-frontend": "cd frontend && npm install && cd ..",
  "install-both": "npm run install-backend && npm run install-frontend",
  "build": "npm run install-both && cd frontend && npm run build && cd ..",
  "start": "cd backend && node index"
}</div>
                    <p><strong>What happens here:</strong></p>
                    <ul>
                        <li><span class="highlight">install-backend</span>: Navigates to the backend folder, installs dependencies, returns to root</li>
                        <li><span class="highlight">install-frontend</span>: Navigates to the frontend folder, installs dependencies, returns to root</li>
                        <li><span class="highlight">install-both</span>: Runs both install commands</li>
                        <li><span class="highlight">build</span>: Installs everything, then builds the React app into production files</li>
                        <li><span class="highlight">start</span>: Starts the Express server</li>
                    </ul>

                    <h3><span class="step-number">2</span>React Build Process</h3>
                    <p>When you run <span class="highlight">npm run build</span> in the frontend, React creates optimized production files in the <span class="highlight">dist</span> folder:</p>
                    <div class="code-block">frontend/dist/
  â”œâ”€â”€ index.html
  â”œâ”€â”€ assets/
  â”‚   â”œâ”€â”€ index-abc123.js
  â”‚   â””â”€â”€ index-xyz789.css
  â””â”€â”€ ...</div>
                    <p>These are static files that can be served by any web server - including Express!</p>

                    <h3><span class="step-number">3</span>Express Serving Static Files</h3>
                    <div class="code-block">const reactHtml = path.join(import.meta.dirname, "../frontend/dist/index.html");

// Serve React's index.html for the root route
for (const route of frontendRoutes) {
  app.get(route, (req, res) => {
    res.sendFile(reactHtml);
  });
}

// Serve all other static files (JS, CSS, images)
app.use(express.static("../frontend/dist"));</div>

                    <div class="important">
                        <strong>ðŸ”‘ Key Concept:</strong> Express has TWO jobs now:
                        <ul style="margin-top: 10px;">
                            <li><strong>API Server</strong>: Handle API routes like <span class="highlight">/api/users</span></li>
                            <li><strong>File Server</strong>: Serve the React application files</li>
                        </ul>
                    </div>

                    <h3><span class="step-number">4</span>How It Works in Detail</h3>
                    <p><strong>Path resolution:</strong></p>
                    <p><span class="highlight">import.meta.dirname</span> gives the current directory (backend folder). We go up one level with <span class="highlight">..</span> and into <span class="highlight">frontend/dist</span> to find the built React files.</p>

                    <p><strong>Route handling:</strong></p>
                    <p>The <span class="highlight">frontendRoutes</span> array (currently just <span class="highlight">["/"]</span>) defines which URLs should serve the React app's <span class="highlight">index.html</span>. This is the entry point to your React application.</p>

                    <p><strong>Static files middleware:</strong></p>
                    <p><span class="highlight">express.static("../frontend/dist")</span> automatically serves all files from the dist folder. When React's index.html requests <span class="highlight">/assets/index-abc123.js</span>, Express finds and serves it.</p>
                </section>

                <section>
                    <h2>Request Flow Example</h2>
                    <p><strong>User visits http://yourapp.com/</strong></p>
                    <ol>
                        <li>Express receives the request</li>
                        <li>Matches the <span class="highlight">/</span> route</li>
                        <li>Sends <span class="highlight">frontend/dist/index.html</span></li>
                        <li>Browser loads index.html</li>
                        <li>Browser requests JavaScript/CSS files</li>
                        <li>Express serves those from <span class="highlight">frontend/dist</span> via static middleware</li>
                        <li>React app loads and runs in the browser!</li>
                    </ol>

                    <p style="margin-top: 20px;"><strong>User makes API request to /api/data</strong></p>
                    <ol>
                        <li>Express receives the request</li>
                        <li>Checks routes - no static file match</li>
                        <li>Matches your API route handler</li>
                        <li>Returns JSON data</li>
                    </ol>
                </section>

                <section>
                    <h2>Deployment Process</h2>
                    <p><strong>On your deployment platform (like Render, Heroku, etc.):</strong></p>
                    <ol>
                        <li>Run <span class="highlight">npm run build</span> - Installs dependencies and builds React</li>
                        <li>Run <span class="highlight">npm start</span> - Starts the Express server</li>
                        <li>Express serves everything from one port/URL</li>
                    </ol>

                    <div class="important">
                        <strong>ðŸ’¡ Why this approach?</strong>
                        <ul style="margin-top: 10px;">
                            <li>Single deployment - no CORS issues</li>
                            <li>Same domain for frontend and backend</li>
                            <li>Easier to manage in production</li>
                            <li>Cost-effective (one server instead of two)</li>
                        </ul>
                    </div>
                </section>
            </div>

            <!-- SPANISH CONTENT -->
            <div class="lang-content" data-lang="es">
                <section>
                    <h2>La VisiÃ³n General</h2>
                    <p>Tienes dos aplicaciones separadas que necesitan trabajar juntas como una:</p>
                    <div class="diagram">
                        <div class="box backend">Backend (Express)</div>
                        <span class="arrow">+</span>
                        <div class="box frontend">Frontend (React)</div>
                        <span class="arrow">â†’</span>
                        <div class="box combined">Despliegue Ãšnico</div>
                    </div>
                    <p>El objetivo es hacer que Express sirva tanto los endpoints de la API COMO la aplicaciÃ³n React desde la misma URL.</p>
                </section>

                <section>
                    <h2>ExplicaciÃ³n Paso a Paso</h2>

                    <h3><span class="step-number">1</span>ConfiguraciÃ³n de Scripts de ConstrucciÃ³n</h3>
                    <div class="code-block">"scripts": {
  "install-backend": "cd backend && npm install && cd ..",
  "install-frontend": "cd frontend && npm install && cd ..",
  "install-both": "npm run install-backend && npm run install-frontend",
  "build": "npm run install-both && cd frontend && npm run build && cd ..",
  "start": "cd backend && node index"
}</div>
                    <p><strong>QuÃ© sucede aquÃ­:</strong></p>
                    <ul>
                        <li><span class="highlight">install-backend</span>: Navega a la carpeta backend, instala dependencias, regresa a la raÃ­z</li>
                        <li><span class="highlight">install-frontend</span>: Navega a la carpeta frontend, instala dependencias, regresa a la raÃ­z</li>
                        <li><span class="highlight">install-both</span>: Ejecuta ambos comandos de instalaciÃ³n</li>
                        <li><span class="highlight">build</span>: Instala todo, luego construye la app React en archivos de producciÃ³n</li>
                        <li><span class="highlight">start</span>: Inicia el servidor Express</li>
                    </ul>

                    <h3><span class="step-number">2</span>Proceso de ConstrucciÃ³n de React</h3>
                    <p>Cuando ejecutas <span class="highlight">npm run build</span> en el frontend, React crea archivos de producciÃ³n optimizados en la carpeta <span class="highlight">dist</span>:</p>
                    <div class="code-block">frontend/dist/
  â”œâ”€â”€ index.html
  â”œâ”€â”€ assets/
  â”‚   â”œâ”€â”€ index-abc123.js
  â”‚   â””â”€â”€ index-xyz789.css
  â””â”€â”€ ...</div>
                    <p>Â¡Estos son archivos estÃ¡ticos que pueden ser servidos por cualquier servidor web - incluyendo Express!</p>

                    <h3><span class="step-number">3</span>Express Sirviendo Archivos EstÃ¡ticos</h3>
                    <div class="code-block">const reactHtml = path.join(import.meta.dirname, "../frontend/dist/index.html");

// Servir el index.html de React para la ruta raÃ­z
for (const route of frontendRoutes) {
  app.get(route, (req, res) => {
    res.sendFile(reactHtml);
  });
}

// Servir todos los demÃ¡s archivos estÃ¡ticos (JS, CSS, imÃ¡genes)
app.use(express.static("../frontend/dist"));</div>

                    <div class="important">
                        <strong>ðŸ”‘ Concepto Clave:</strong> Express ahora tiene DOS trabajos:
                        <ul style="margin-top: 10px;">
                            <li><strong>Servidor API</strong>: Manejar rutas API como <span class="highlight">/api/users</span></li>
                            <li><strong>Servidor de Archivos</strong>: Servir los archivos de la aplicaciÃ³n React</li>
                        </ul>
                    </div>

                    <h3><span class="step-number">4</span>CÃ³mo Funciona en Detalle</h3>
                    <p><strong>ResoluciÃ³n de rutas:</strong></p>
                    <p><span class="highlight">import.meta.dirname</span> da el directorio actual (carpeta backend). Subimos un nivel con <span class="highlight">..</span> y entramos en <span class="highlight">frontend/dist</span> para encontrar los archivos React construidos.</p>

                    <p><strong>Manejo de rutas:</strong></p>
                    <p>El array <span class="highlight">frontendRoutes</span> (actualmente solo <span class="highlight">["/"]</span>) define quÃ© URLs deben servir el <span class="highlight">index.html</span> de la app React. Este es el punto de entrada a tu aplicaciÃ³n React.</p>

                    <p><strong>Middleware de archivos estÃ¡ticos:</strong></p>
                    <p><span class="highlight">express.static("../frontend/dist")</span> sirve automÃ¡ticamente todos los archivos de la carpeta dist. Cuando el index.html de React solicita <span class="highlight">/assets/index-abc123.js</span>, Express lo encuentra y sirve.</p>
                </section>

                <section>
                    <h2>Ejemplo de Flujo de Solicitud</h2>
                    <p><strong>Usuario visita http://tuapp.com/</strong></p>
                    <ol>
                        <li>Express recibe la solicitud</li>
                        <li>Coincide con la ruta <span class="highlight">/</span></li>
                        <li>EnvÃ­a <span class="highlight">frontend/dist/index.html</span></li>
                        <li>El navegador carga index.html</li>
                        <li>El navegador solicita archivos JavaScript/CSS</li>
                        <li>Express los sirve desde <span class="highlight">frontend/dist</span> vÃ­a middleware estÃ¡tico</li>
                        <li>Â¡La app React se carga y ejecuta en el navegador!</li>
                    </ol>

                    <p style="margin-top: 20px;"><strong>Usuario hace solicitud API a /api/data</strong></p>
                    <ol>
                        <li>Express recibe la solicitud</li>
                        <li>Verifica rutas - no hay coincidencia con archivo estÃ¡tico</li>
                        <li>Coincide con tu manejador de ruta API</li>
                        <li>Devuelve datos JSON</li>
                    </ol>
                </section>

                <section>
                    <h2>Proceso de Despliegue</h2>
                    <p><strong>En tu plataforma de despliegue (como Render, Heroku, etc.):</strong></p>
                    <ol>
                        <li>Ejecuta <span class="highlight">npm run build</span> - Instala dependencias y construye React</li>
                        <li>Ejecuta <span class="highlight">npm start</span> - Inicia el servidor Express</li>
                        <li>Express sirve todo desde un puerto/URL</li>
                    </ol>

                    <div class="important">
                        <strong>ðŸ’¡ Â¿Por quÃ© este enfoque?</strong>
                        <ul style="margin-top: 10px;">
                            <li>Despliegue Ãºnico - sin problemas de CORS</li>
                            <li>Mismo dominio para frontend y backend</li>
                            <li>MÃ¡s fÃ¡cil de gestionar en producciÃ³n</li>
                            <li>EconÃ³mico (un servidor en lugar de dos)</li>
                        </ul>
                    </div>
                </section>
            </div>
        </div>
    </div>

    <script>
        function setLanguage(lang) {
            const allContent = document.querySelectorAll('.lang-content');
            const allBtns = document.querySelectorAll('.lang-btn');
            
            allContent.forEach(el => {
                if (el.dataset.lang === lang) {
                    el.classList.add('active');
                } else {
                    el.classList.remove('active');
                }
            });
            
            allBtns.forEach(btn => {
                btn.classList.remove('active');
            });
            
            event.target.classList.add('active');
        }
    </script>
</body>
</html>